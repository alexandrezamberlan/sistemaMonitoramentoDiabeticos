{% extends 'appcliente/base.html' %}
{% load bootstrap3 %}

{% block title %}
	{% bootstrap_icon 'cutlery' %} Minhas refeições
{% endblock %}

{% block content %}
	<div class="panel panel-default">
		<div class="panel-body">
            <form class="form">
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
                        {% bootstrap_field form.pesquisa  %}
                    </div>	
                    <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
                        <br>
                        <button type="submit" class="btn btn-success btn-md"  style="width: 100%;">{% bootstrap_icon 'search' %} Buscar</button>
                    </div>			
                    <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
                        <br>
                        <a href="{% url 'appcliente_registrorefeicao_create' %}" class="btn btn-md btn-primary" style="width: 100%;">{% bootstrap_icon 'record' %} Registrar refeição</a>
                    </div>			
                </div>
            </form>
		</div>     
	</div>

	<div class="table-responsive">
		<table class="table table-hover">
			<thead>
				<th>Recomendações</th>
				<th>Registro Alimentação</th>
				<th class="text-center">Excluir</th>
			</thead>
			<tbody>
				{% for refeicao in object_list %}
					<tr>
						<td>
							{% if refeicao.quantidade_insulina_recomendada %}
                                {% if refeicao.nome_insulina %}
                                    Insulina <b>{{ refeicao.nome_insulina }}</b>
                                {% endif %}
								<span class="label label-info"> {{ refeicao.quantidade_insulina_recomendada }} U </span>
							{% else %}
                                <span class="label label-warning"> SEM APLICAÇÃO </span>
                            {% endif %}
							<br>
							Quando: <small class="text-muted">{{ refeicao.data_hora_registro|date:"d/m/Y H:i" }}</small>
                            <br>
                            <small class="text-muted"> Bolus alimentar: {{ refeicao.cliente.bolus_alimentar|default:"SEM" }} </small>
                            <br><small class="text-muted"> Bolus correção: {{ refeicao.cliente.bolus_correcao|default:"SEM" }} </small>
                            <br><small class="text-muted"> Glicemia meta: {{ refeicao.cliente.glicemia_meta|default:"SEM" }} </small>
						</td>
                        <td>
							{{ refeicao.registro_alimentacao|linebreaksbr }}
							{% if refeicao.glicemia_vigente %}
								<br><small class="text-muted">Glicemia vigente: {{ refeicao.glicemia_vigente }} mg/dL</small>
							{% endif %}
							{% if refeicao.total_carboidratos %}
								<br><small class="text-muted">Total carb.: {{ refeicao.total_carboidratos }} g</small>
							{% endif %}
							{% if refeicao.total_calorias %}
								<br><small class="text-muted">Total kcal.: {{ refeicao.total_calorias }} kcal</small>
							{% endif %}
						</td>
						<td class="text-center">
							{% bootstrap_button content='' href=refeicao.get_delete_cliente_url button_type='link' icon='trash' button_class='btn btn-danger' size='sm' %}
						</td>
					</tr>
				{% endfor %}
			</tbody>
			<tfoot>
				<th colspan="3">
					Total de registros: {{ object_list|length }}
				</th>
			</tfoot>
		</table>
	</div>
{% endblock %}